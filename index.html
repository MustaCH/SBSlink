<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="https://i.ibb.co/0rVDbnK/SBS808-LOGOredu-RED.png"
    />
    <link
      rel="mask-icon"
      href="https://i.ibb.co/0rVDbnK/SBS808-LOGOredu-RED.png"
      color="#226DAA"
    />
    <link
      rel="icon"
      sizes="16x16 32x32 48x48"
      type="image/png"
      href="https://i.ibb.co/0rVDbnK/SBS808-LOGOredu-RED.png"
    />
    <script src="https://cdn.tailwindcss.com"></script>
    <title>Subsuelo 808 - ¡Comprá tu entrada!</title>
  </head>
  <body
    class="relative m-8 my-14 lg:mx-56 bg-[url('https://i.ibb.co/LkMQhVw/bg-img-3.jpg')] bg-no-repeat bg-black"
  >
    <header>
      <div class="flex justify-center">
        <img
          class="w-56"
          src="https://i.ibb.co/JvhG82X/SBS808-LOGOcomp-RED.png"
          alt="SBS808-LOGOcomp-RED"
        />
      </div>
    </header>
    <main class="flex flex-col text-center">
      <div class="flex flex-col gap-12 items-center my-44">
        <h1 class="uppercase font-semibold text-white drop-shadow-xl">
          Compra tu entrada acá
        </h1>
        <script
          id="mercadoPagoScript"
          src="https://www.mercadopago.com.ar/integrations/v1/web-payment-checkout.js"
          data-preference-id="212804722-874eb2c3-952e-47f8-bdf4-21a0ed0401c3"
          data-source="button"
        ></script>
        <p class="text-white">
          Recibirás tu entrada <strong>vía email</strong> dentro de las proximas
          24hs
        </p>
      </div>
    </main>
    <footer class="my-8">
      <p
        class="text-xs text-white fixed bottom-0 left-0 px-4 py-4 backdrop-blur-xl w-full"
      >
        Subsuelo 808® es un evento de indole privada. La organización se reserva
        el derecho de admisión o permanencia primando siempre por el bienestar
        de los asistentes, así como del staff del evento y del establecimiento
        donde se lleva a cabo.<br />
        Dudas, consultas o reclamos comunicarse por medio de
        <a class="underline" href="https://wa.me/393515755357">Whatsapp</a> o
        <a class="underline" href="https://www.instagram.com/subsuelo808/"
          >Instagram</a
        >
        de lunes a viernes de 10:00hs a 20:00hs.
      </p>
    </footer>
    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.5.2/firebase-app.js";
      import {
        getFirestore,
        collection,
        doc,
        getDoc,
      } from "https://www.gstatic.com/firebasejs/10.5.2/firebase-firestore.js";

      const firebaseConfig = {
        apiKey: "AIzaSyDb6_cvgO0yiNr7LznDjjz3MoD71sIX870",
        authDomain: "sbsticket.firebaseapp.com",
        projectId: "sbsticket",
        storageBucket: "sbsticket.appspot.com",
        messagingSenderId: "598909285517",
        appId: "1:598909285517:web:7d9b6ddf92808e00c59ec4",
      };

      const app = initializeApp(firebaseConfig);
      const db = getFirestore(app);

      async function getEventLink() {
        try {
          // Obtén una referencia al documento "main-event" en la colección "events"
          const eventRef = doc(collection(db, "events"), "main-event");

          // Obten el documento
          const eventDoc = await getDoc(eventRef);

          if (eventDoc.exists()) {
            // El documento existe, obtén el valor de "link"
            const eventData = eventDoc.data();
            const link = eventData.link;
            return link;
          } else {
            console.error("El documento 'main-event' no existe.");
            return null;
          }
        } catch (error) {
          console.error("Error al obtener el enlace del evento: ", error);
          return null;
        }
      }

      // Llama a la función para obtener el enlace del evento
      getEventLink().then((link) => {
        if (link) {
          console.log("Enlace del evento:", link);
          const scriptElement = document.getElementById("mercadoPagoScript");

          // Actualiza la propiedad src con el enlace obtenido de Firebase
          scriptElement.src = link;
          // Puedes usar el enlace como desees en tu página HTML
        }
      });
    </script>
  </body>
</html>
